var Ne=Object.defineProperty,We=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var re=(e,t,n)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=(e,t)=>{for(var n in t||(t={}))ie.call(t,n)&&re(e,n,t[n]);if($)for(var n of $(t))le.call(t,n)&&re(e,n,t[n]);return e},W=(e,t)=>We(e,ke(t));var ce=(e,t)=>{var n={};for(var s in e)ie.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&$)for(var s of $(e))t.indexOf(s)<0&&le.call(e,s)&&(n[s]=e[s]);return n};import{l as De,f as Me,a as Re,b as Oe,c as Ie,r as d,R as o,C as ze,t as ye,F as Q,d as Pe}from"./vendor.83369c53.js";import{i as Ue,c as _e,a as de,p as Te,b as Fe,h as Xe,X as Be,d as Le,e as Ye,f as Ve}from"./shared.8ef0681a.js";const Ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};Ge();/**
 * Xpra Typescript Client Example
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */const He=[Me,Re,Oe,Ie];He.forEach(e=>De.add(e));/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */const Z=(...e)=>e.join(" ");function ve(){localStorage.getItem("theme")==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}function Ze(){const e=localStorage.getItem("theme");localStorage.setItem("theme",e==="dark"?"light":"dark"),ve()}function Ke(){const e=window.matchMedia("(prefers-color-scheme: dark)"),t=n=>{n.matches?localStorage.setItem("theme","dark"):localStorage.setItem("theme","light"),ve()};e.addEventListener("change",t),t(e)}function qe(e){if(e){const{image:t,xhot:n,yhot:s}=e;return`transparent url('${t}') no-repeat ${n}px ${s}px`}return""}function $e(e,t=""){if(e){const{image:n,xhot:s,yhot:r}=e,i=t?`, ${t}`:"";return`url('${n}') ${s} ${r}${i}`}return t}function me(e,t,n){let s="";const{width:r,height:i,x:l,y:u}=e.getBoundingClientRect(),E=t[0]-l,c=t[1]-u;return c<=n?s+="n":c>=i-n&&(s+="s"),E<=n?s+="w":E>=r-n&&(s+="e"),s}function ue(e){const{onDown:t,onMove:n,onRelease:s}=e();return r=>{r.preventDefault();const i=r.pageX,l=r.pageY;let u=!1;const E=w=>{w.stopPropagation();const b=w.pageX-i,y=w.pageY-l;u=!0,n(w,b,y)},c=w=>{window.removeEventListener("mousemove",E,!0),window.removeEventListener("mouseup",c,!0),s(w,u)};window.addEventListener("mousemove",E,!0),window.addEventListener("mouseup",c,!0),t&&t(r.nativeEvent,i,l)}}function pe({opacity:e}){if(typeof e=="number")return e<0?1:e/4294967296}/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */var h=(e=>(e.SetHost="SET_HOST",e.SetShowOptions="SET_SHOW_OPTIONS",e.AddWindow="ADD_WINDOW",e.RemoveWindow="REMOVE_WINDOW",e.SetWindowIcon="SET_WINDOW_ICON",e.SetConnected="SET_CONNECTED",e.SetCursor="SET_CURSOR",e.UpdateStats="UPDATE_STATS",e.MoveResizeWindow="MOVE_RESIZE_WINDOW",e.MaximizeWindow="MAXIMIZE_WINDOW",e.UpdateMetadata="UPDATE_METADATA",e.RaiseWindow="RAISE_WINDOW",e.AddNotification="ADD_NOTIFICATION",e.RemoveNotification="REMOVE_NOTIFICATION,",e.SetDraggingWindow="SET_DRAGGING_WINDOW",e.ClearWindows="CLEAR_WINDOWS",e.SetOption="SET_OPTION",e.UpdateMenu="UPDATE_MENU",e.SetError="SET_ERROR",e.SetStarted="SET_STARTED",e))(h||{});let fe=1;const J={connect:!1,host:"ws://127.0.0.1:10000",showOptions:!1,connected:!1,cursor:null,windows:[],notifications:[],activeWindow:0,draggingWindow:-1,actualDesktopSize:[0,0],stats:g({},Ue),options:g({},_e()),menu:[],error:"",started:!1};function je(e,t){var s,r;const n=(i,l)=>{const u=e.windows,E=u.find(c=>c.id===i);return E&&Object.assign(E,l(E)),W(g({},e),{windows:u})};switch(t.type){case"SET_HOST":return W(g({},e),{host:t.payload});case"SET_SHOW_OPTIONS":return W(g({},e),{showOptions:t.payload});case"ADD_WINDOW":const i=!!t.payload.metadata.tray;return W(g({},e),{activeWindow:t.payload.id,windows:[...e.windows,{id:t.payload.id,minimized:t.payload.metadata.iconic===!0,maximized:!1,title:t.payload.metadata.title||String(t.payload.id),position:t.payload.position,dimension:t.payload.dimension,minDimension:(s=t.payload.metadata["size-constraints"])==null?void 0:s["minimum-size"],maxDimension:(r=t.payload.metadata["size-constraints"])==null?void 0:r["maximum-size"],opacity:pe(t.payload.metadata),tray:i,zIndex:i?0:de(t.payload,++fe)}]});case"REMOVE_WINDOW":const{windows:l}=e,u=l.findIndex(k=>k.id===t.payload);u!==-1&&l.splice(u,1);const E=l.length>0?l[l.length-1].id:0;return W(g({},e),{activeWindow:E,windows:l});case"SET_WINDOW_ICON":const c=t.payload;return n(c.wid,()=>({icon:c}));case"SET_CONNECTED":return W(g({},e),{started:!1,windows:t.payload?e.windows:[],connected:t.payload});case"SET_CURSOR":return W(g({},e),{cursor:t.payload});case"UPDATE_STATS":return W(g({},e),{stats:g(g({},e.stats),t.payload)});case"MOVE_RESIZE_WINDOW":const{wid:w,position:b,dimension:y}=t.payload;return n(w,k=>({position:b||k.position,dimension:y||k.dimension}));case"MAXIMIZE_WINDOW":const{maximize:S}=t.payload;return n(t.payload.wid,k=>({oldPosition:S?k.position:void 0,oldDimension:S?k.dimension:void 0,position:S?t.payload.position:k.oldPosition,dimension:S?t.payload.dimension:k.oldDimension,maximized:S}));case"UPDATE_METADATA":const{title:a,iconic:f}=t.payload.metadata;return n(t.payload.wid,k=>({opacity:pe(t.payload.metadata),minimized:f===void 0?k.minimized:f===!0,title:a===void 0?k.title:a}));case"RAISE_WINDOW":return W(g({},n(t.payload.id,()=>({zIndex:de(t.payload,++fe)}))),{activeWindow:t.payload.id});case"ADD_NOTIFICATION":return W(g({},e),{notifications:[...e.notifications,t.payload]});case"REMOVE_NOTIFICATION,":const{notifications:v}=e,O=v.findIndex(([k])=>k.id===t.payload);return O!==-1&&v.splice(O,1),W(g({},e),{notifications:v});case"SET_DRAGGING_WINDOW":return W(g({},e),{draggingWindow:t.payload});case"CLEAR_WINDOWS":return W(g({},e),{cursor:null,windows:[],notifications:[],draggingWindow:-1});case"SET_OPTION":const[M,C]=t.payload;return W(g({},e),{options:W(g({},e.options),{[M]:C})});case"UPDATE_MENU":return W(g({},e),{menu:t.payload});case"SET_ERROR":return W(g({},e),{error:t.payload});case"SET_STARTED":return W(g({},e),{started:t.payload});default:return e}}/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */const T=d.exports.createContext({wm:null,xpra:null,state:J,root:null,setRoot:()=>{},setCursor:()=>{},dispatch:()=>{}}),Qe=Te(window.location.search,{booleans:["connect"],required:["connect","host"]}),Je=Fe(),et=W(g(g({},J),Qe),{options:g(g({},J.options),Je)}),tt=({children:e,wm:t,xpra:n})=>{const[s,r]=d.exports.useReducer(je,et),[i,l]=d.exports.useState(null),[u,E]=d.exports.useState(null),c=()=>{r({type:h.SetConnected,payload:!0}),r({type:h.SetError,payload:""})},w=m=>{r({type:h.SetConnected,payload:m!=="disconnected"}),r({type:h.ClearWindows})},b=m=>r({type:h.AddWindow,payload:m}),y=m=>{r({type:h.RemoveWindow,payload:m}),t.removeWindow(m)},S=m=>r({type:h.SetWindowIcon,payload:m}),a=m=>r({type:h.UpdateStats,payload:m}),f=m=>r({type:h.SetCursor,payload:m}),v=m=>r({type:h.MoveResizeWindow,payload:m}),O=m=>{const U=t.getWindow(m);U&&r({type:h.RaiseWindow,payload:U.attributes})},M=m=>r({type:h.UpdateMetadata,payload:m}),C=m=>{},k=async m=>r({type:h.AddNotification,payload:[m,await t.createNotification(m)]}),K=m=>r({type:h.RemoveNotification,payload:m}),Y=m=>{if(u){const[U,L]=m.position;Object.assign(u.style,{left:`${U}px`,top:`${L}px`})}},F=m=>r({type:h.SetError,payload:m}),V=m=>r({type:h.UpdateMenu,payload:m}),G=()=>r({type:h.SetStarted,payload:!0}),H=(m,U)=>{if(m.digest.startsWith("keycloak"))Xe(m,U);else{const L=prompt("Login password");U(L||"")}};return d.exports.useEffect(()=>(n.on("connect",c),n.on("disconnect",w),n.on("newWindow",b),n.on("removeWindow",y),n.on("windowIcon",S),n.on("pong",a),n.on("cursor",f),n.on("moveResizeWindow",v),n.on("updateWindowMetadata",M),n.on("raiseWindow",O),n.on("initiateMoveResize",C),n.on("showNotification",k),n.on("hideNotification",K),n.on("pointerPosition",Y),n.on("newTray",b),n.on("updateXDGMenu",V),n.on("error",F),n.on("sessionStarted",G),n.on("challengePrompt",H),()=>{n.off("connect",c),n.off("disconnect",w),n.off("newWindow",b),n.off("removeWindow",y),n.off("windowIcon",S),n.off("pong",a),n.off("cursor",f),n.off("moveResizeWindow",v),n.off("updateWindowMetadata",M),n.off("raiseWindow",O),n.off("initiateMoveResize",C),n.off("showNotification",k),n.off("hideNotification",K),n.off("pointerPosition",Y),n.off("newTray",b),n.off("updateXDGMenu",V),n.off("error",F),n.off("sessionStarted",G),n.off("challengePrompt",H)}),[]),d.exports.useEffect(()=>{s.connect&&n.connect(s.host,s.options)},[]),d.exports.useEffect(()=>{t.setDesktopElement(i)},[i]),d.exports.useEffect(()=>{t.setActiveWindow(s.activeWindow)},[s.activeWindow]),o.createElement(T.Provider,{value:{state:s,dispatch:r,root:i,wm:t,xpra:n,setRoot:l,setCursor:E}},e)};/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */const nt=300,B=({toggled:e,children:t,mountOnEnter:n=!0,unmountOnExit:s=!0})=>o.createElement(ze,{in:e,timeout:nt,mountOnEnter:n,unmountOnExit:s,classNames:"fade-on-out"},t);var ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAASdAAAEnQB3mYfeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAUdEVYdEF1dGhvcgBKYWt1YiBTdGVpbmVy5vv3LwAAADV0RVh0RGVzY3JpcHRpb24ASW52ZXJ0ZWQgdmFyaWFudCBvZiB0aGUgRE1aIGN1cnNvciB0aGVtZS5odVs8AAAAM3RFWHRTb3VyY2UAaHR0cDovL2ppbW1hYy5tdXNpY2hhbGwuY3ovdGhlbWVzLnBocD9za2luPTdQM5WxAAADwUlEQVRYhe2WTUhsZRjHf+PVcdLU48d1GkMvdwI185ZIzEYpaKttWqhcKhlFF65USjcK6equNFJbCEokiISiochQgfmBaI6CKGmg5MeIwpBXZpIRPec8LWb0Wte6c1SsRX94eDcvvD+er/8L/+sFEpFX/833o3Vd9zc3N78FxAIRdw0QKyISCAT8xcXFDuDlu4aIl5D8fr+voKDgbe44E/EiIu3t7eL3+8Xn8x3l5ua+GYIw3RlAeXm5FBUVSSAQEJ/Pd2i32x8BMbcBEVYqdV1nfn4ep9OJxWJJXFpa+t5msz0AXropRFgAmqahqiqTk5NUVVURGxtrXV1ddQFpgOUmEIYAVFVlYmKCuro6FEXJ8Hq93wE2IPq6EGEBiMgFgKqquFwuGhoaSE5Ofri/v/8t8Mp1IcIep8sAqqoyPj5Oa2srVqs1d29vbwiwAmajENcGUFWV4eFh2traSEtLy9/Z2fkGSDUKYWihXAUxMDBAZ2cn6enpjo2Nja+A+0YgDANcbsjz6O/vp6+vD7vd/t7a2tqXQAoQFQ6EIYC/NuPl6OnpYXBwkKysrPdXVla+CBfC8E6/6vHzrHR3dzM8PExOTs4HCwsLT4BkIPKfICKNAlwuAYDD4cBisWA2m4mOjmZxcZG8vDzy8/M/mpmZ+b2wsPAz4ClwZvQtCHlBSUmJABcRGRkpcXFxYrVaxe12y99J13WZnp5+Aii3lgGAsrIyxsbGUFWVrq4uent76ejo+GFoaOgns9l8bDKZxGQy6WazOSAivxJcUtfScxmora0VXdelpqZGEhISxGazyebmpni93qdAEfA6YAceAg8ILqiYWwFoaGgQXdfl9PRU9Xg8oiiKpKSkSH19vWiaJk1NTY0EvcEM3AtFBDcwqwuAxsZGERFZXFxcdzqdn2uaJtXV1aIoimRkZMjBwYEcHBx4gDe4oUM+BzA3Nye6rsvs7OwK8DFQcHR05Nna2hJFUSQ1NVVaWlpEVVWprKysIDh+t/Jtiz/v5qmpqSXgQ+ARkDw6OvpY0zSpqKiQpKQkyczMlOPjY1leXp4DXiO4hG4HYH5+/kegDMgF4ghOj+L3+/c2NjYkMTFRsrOz5fDwUNbX138OQd5KGWJ3d3e/Bt4Bsnn2LTcBUS6X6/HZ2Zlsb29LIBCQk5MTvbS0tCV017A1X6UoIJGgw8Xw57qagPiRkZFPPB7PL2632+1wOD4F3iXoA2H1wIsITQRHSQA9dF7WPYIluU/wg3oC/Ab4APWK+4YBwlEEz2ZeC8X54vrv6w+aYEf+AZkZtAAAAABJRU5ErkJggg==";/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */const Ee=16;let ge=!1;const at=({win:e,bar:t,winstance:n})=>{const{oldPosition:s,oldDimension:r}=e,{wm:i,xpra:l,root:u,dispatch:E}=d.exports.useContext(T),c="w-4 h-4 rounded-full cursor-pointer bg-gradient-to-b shadow-inner hover:shadow",w=y=>{y.stopPropagation(),y.preventDefault()},b=()=>{if(t.current&&u)if(e.maximized)s&&r&&(i.maximize(n,s,r),E({type:h.MaximizeWindow,payload:{wid:e.id,maximize:!1}}));else{const S=t.current.offsetHeight,a=u.offsetWidth,f=u.offsetHeight-S;i.maximize(n,[0,S],[a,f]),E({type:h.MaximizeWindow,payload:{wid:e.id,position:[0,S],dimension:[a,f],maximize:!0}})}};return o.createElement("div",{className:"flex items-center space-x-2",onMouseDown:w},o.createElement("div",{title:"Minimize",className:`${c} from-green-300 to-green-500 hover:from-green-400`,onClick:()=>i.minimize(n)}),o.createElement("div",{title:"Maximize",className:`${c} from-blue-300 to-blue-500 hover:from-blue-400`,onClick:b}),!l.isReadOnly()&&o.createElement("div",{title:"Close",className:`${c} from-red-300 to-red-500 hover:from-red-400`,onClick:()=>i.close(n)}))},he=({win:{icon:e,title:t}})=>o.createElement(o.Fragment,null,e&&o.createElement("img",{alt:t,src:e.image,className:"max-h-full"}),!e&&o.createElement("div",{className:"h-full w-full rounded bg-gray-500"})),ee=({id:e})=>{const t=d.exports.useRef(null),{wm:n,state:s}=d.exports.useContext(T),r=n.getWindow(e),i=s.draggingWindow>=0?"pointer-events-none":"",l=c=>{n.mouseButton(r,c.nativeEvent,!0)},u=c=>{c.stopPropagation(),n.mouseButton(r,c.nativeEvent,!1)},E=c=>{c.preventDefault(),c.stopPropagation(),n.mouseMove(r,c.nativeEvent)};return d.exports.useEffect(()=>{t.current&&(r==null?void 0:r.canvas)&&t.current.appendChild(r.canvas)},[t.current]),o.createElement("div",{ref:t,className:i,onMouseDown:l,onMouseUp:u,onMouseMove:E})},st=({win:e})=>{var se;const{id:t,position:n,dimension:s,title:r,minimized:i,maximized:l,opacity:u,zIndex:E,minDimension:c,maxDimension:w}=e,[b,y]=d.exports.useState("default"),{wm:S,dispatch:a,xpra:f}=d.exports.useContext(T),v=d.exports.useRef(null),O=d.exports.useRef(null),M=d.exports.useRef(null),C=S.getWindow(t),k={opacity:u,zIndex:E},K={cursor:b},Y={toggled:!i,mountOnEnter:!1,unmountOnExit:!1},F=(p,N,A,x,D=!1)=>{v.current&&Object.assign(v.current.style,{left:`${p}px`,top:`${N}px`,width:`${A}px`,height:`${x}px`}),C!=null&&C.canvas&&Object.assign(C.canvas.style,{width:`${A}px`,height:`${x}px`}),D&&a({type:h.MoveResizeWindow,payload:{wid:t,position:[p,N],dimension:[A,x]}})},V=(p=!1)=>{const[N,A]=n,[x,D]=s;F(N,A,x,D,p)},G=p=>(N,A,x,D,I)=>{const[z,P]=c||[100,100],[_,q]=w||[Number.MAX_VALUE,Number.MAX_VALUE];x=Math.min(_,Math.max(z,x)),D=Math.min(q,Math.max(P,D)),p(N,A,x,D,I)},H=G((p,N,A,x)=>{!f.isReadOnly()&&!l&&F(p,N,A,x),U(!0)}),m=G((p,N,A,x,D)=>{U(!1),!f.isReadOnly()&&!l&&(F(p,N,A,x,!0),D&&S.moveResize(C,[p,N],[A,x]))}),U=p=>{(!p||!ge)&&a({type:h.SetDraggingWindow,payload:p?t:-1}),ge=p},L=p=>{p.preventDefault(),p.stopPropagation()},ae=p=>{p.preventDefault(),p.stopPropagation(),S.raise(C),a({type:h.RaiseWindow,payload:C.attributes})},Ae=ye(p=>{if(M.current){const N=me(M.current,[p.pageX,p.pageY],Ee);y(`${N}-resize`)}else y("default")},100),be=d.exports.useCallback(ue(()=>{const[p,N]=s;let[A,x]=n,D=0;return{onDown(){var I;D=((I=O.current)==null?void 0:I.offsetHeight)||0},onMove(I,z,P){A=n[0]+z,x=Math.max(D,n[1]+P),H(A,x,p,N),U(!0)},onRelease(I,z){m(A,x,p,N,z)}}}),[n,s]),Ce=d.exports.useCallback(ue(()=>{let p="",N=0,[A,x]=n,[D,I]=s;return{onDown(z,P,_){var q;z.stopPropagation(),M.current&&(p=me(M.current,[P,_],Ee),N=((q=O.current)==null?void 0:q.offsetHeight)||0)},onMove(z,P,_){p.startsWith("n")?(x=n[1]+_,x>N?I=s[1]-_:x=N):p.startsWith("s")&&(I=s[1]+_),p.endsWith("w")?(D=s[0]-P,A=n[0]+P):p.endsWith("e")&&(D=s[0]+P),H(A,x,D,I)},onRelease(z,P){m(A,x,D,I,P)}}}),[M,n,s]);return d.exports.useEffect(()=>{V()},[n,s]),d.exports.useEffect(()=>{V()},[v]),d.exports.useEffect(()=>{var D,I;if((D=C==null?void 0:C.attributes)!=null&&D.overrideRedirect)return;const[p,N]=n,[A,x]=s;if(!f.isReadOnly()){const z=((I=O.current)==null?void 0:I.offsetHeight)||0;if(p<=0||N<=z){const _=z;S.moveResize(C,[100,_],[A,x]),F(100,_,A,x,!0)}}},[]),(se=C==null?void 0:C.attributes)!=null&&se.overrideRedirect?o.createElement(B,g({},Y),o.createElement("div",{className:"absolute cursor-default bg-black shadow",ref:v,style:k,onMouseDown:ae,onMouseUp:L},o.createElement(ee,{id:t}))):o.createElement(B,g({},Y),o.createElement("div",{ref:v,style:k,className:"absolute",onMouseDown:ae,onMouseUp:L,onMouseMove:Ae},o.createElement("div",{ref:M,className:"absolute -inset-x-2 -top-10 -bottom-2 z-10",style:K,onMouseDown:Ce}),o.createElement("div",{className:"relative z-20 h-full w-full shadow-xl outline outline-1 outline-gray-200 dark:outline-gray-900"},o.createElement("div",{className:"absolute -top-8 flex h-8 w-full cursor-default items-center space-x-2 bg-gray-100 p-1 px-2 outline outline-1 outline-gray-200 dark:bg-gray-900 dark:text-white dark:outline-gray-900",ref:O,onMouseDown:be},o.createElement("div",{className:"flex items-center justify-center",style:{width:"16px",height:"16px"}},o.createElement(he,{win:e})),o.createElement("div",{className:"grow truncate text-sm"},o.createElement("span",null,r||t)),o.createElement(at,{winstance:C,win:e,bar:O,outer:v})),o.createElement("div",{className:"xpra-window-canvas h-full w-full bg-black"},o.createElement(ee,{id:t})))))},rt=({children:e})=>{const t=d.exports.createRef(),n=d.exports.createRef(),{wm:s,state:r,setRoot:i,setCursor:l}=d.exports.useContext(T),u=ye(a=>{s.mouseMove(null,a.nativeEvent)},200),E=a=>{a.preventDefault()},c=d.exports.useCallback(a=>{s.mouseButton(null,a,!0)},[]),w=d.exports.useCallback(a=>{s.mouseButton(null,a,!1)},[]),b=g({dimension:[32,32],xhot:8,yhot:3,image:ot},r.cursor||{}),y=`
.xpra-cursor {
  background: ${qe(b)};
}

.xpra-window-canvas {
  cursor: ${$e(r.cursor,"default")};
}
`,S=r.windows.filter(a=>!a.tray);return d.exports.useEffect(()=>{const a=t.current,f=v=>{a&&(a.contains(v.target)||a===v.target)&&document.activeElement&&document.activeElement.blur()};return a&&(i(a),a.addEventListener("click",f,!0)),()=>{a&&a.removeEventListener("click",f,!0)}},[t.current]),d.exports.useEffect(()=>{n.current&&l(n.current)},[n.current]),o.createElement(o.Fragment,null,o.createElement("div",{id:"xpra-desktop",className:"absolute inset-0 z-30 overflow-hidden bg-gradient-to-br from-emerald-500 via-emerald-300 to-emerald-500 dark:from-emerald-900 dark:via-emerald-700 dark:to-emerald-900",ref:t,onMouseMove:u,onContextMenu:E,onMouseDown:c,onMouseUp:w},r.connected&&S.map(a=>o.createElement(st,{key:a.id,win:a})),e),o.createElement("div",{ref:n,className:"xpra-cursor absolute z-50"}),o.createElement("style",null,y))};/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */let xe=1;const te="bg-white/80 dark:bg-black/80 dark:text-white",ne="rounded border-none p-1 px-2 disabled:opacity-40 disabled:cursor-not-allowed hover:outline hover:outline-1 w-full",we=({disabled:e,label:t,value:n,required:s,options:r,onChange:i})=>{const l=`xpra_${++xe}`,u=Z(ne,te);return o.createElement("div",null,t&&o.createElement("label",{htmlFor:l},t),o.createElement("div",null,o.createElement("select",{className:u,id:l,required:s,disabled:e,defaultValue:n,onChange:i},Object.entries(r).map(([E,c])=>o.createElement("option",{key:E,value:E},c)))))},X=({children:e,disabled:t,label:n,type:s,transparent:r,onClick:i})=>{const l=[];return r||l.push(te),o.createElement("button",{className:Z(ne,...l),disabled:t,type:s||"button",onClick:i},n||e)},j=({disabled:e,label:t,value:n,type:s,placeholder:r,required:i,onChange:l})=>{const u=`xpra_${++xe}`,E=Z(ne,te);return o.createElement("div",null,t&&o.createElement("label",{htmlFor:u},t),o.createElement("div",null,o.createElement("input",{type:s||"text",className:E,id:u,placeholder:r,required:i,disabled:e,defaultValue:n,onInput:l})))},R=({label:e,value:t,onChange:n})=>o.createElement("div",{className:"select-none"},o.createElement("label",{className:"inline-flex cursor-pointer items-center space-x-2"},o.createElement("input",{type:"checkbox",defaultChecked:t,onChange:n}),o.createElement("span",null,e)));/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */const it=["shadow-lg","bg-emerald-100/50","dark:bg-emerald-900/50","opacity-90","rounded"],Se=({items:e,onCallback:t=()=>{},root:n=!0})=>{const s=d.exports.useRef(null),[r,i]=d.exports.useState(-1),l=["max-h-96","max-w-xs"];n?l.push("top-full","left-0"):l.push("top-0","left-full","overflow-auto");const u=w=>i(w),E=()=>i(-1),c=w=>{w&&w(),t()};if(n){const w=b=>{if(s.current){const y=b.target;y&&(s.current.contains(y)||y===s.current.parentNode)||c()}};d.exports.useEffect(()=>(document.addEventListener("click",w),()=>{document.removeEventListener("click",w)}),[s])}return o.createElement("div",{ref:s,className:Z("absolute","shadow","bg-emerald-100/80","dark:bg-emerald-900/80","dark:text-white",...l),onMouseLeave:E},e.map(({icon:w,title:b,items:y,callback:S},a)=>o.createElement("div",{key:a,className:"relative text-left"},o.createElement("div",{className:"flex items-center space-x-2 truncate p-2 hover:bg-white",onClick:()=>c(S),onMouseOver:()=>u(a)},w&&o.createElement("img",{src:w,className:"h-4 w-4"}),o.createElement("span",{className:"grow"},b),y&&y.length&&o.createElement(Q,{icon:"chevron-right"})),r===a&&y&&y.length>0&&o.createElement(Se,{root:!1,items:y}))))},oe=({classNames:e,children:t})=>{const n=Z("absolute","z-50",...it,...e),s=r=>{r.preventDefault()};return o.createElement("div",{className:n,onContextMenu:s},t)},lt=()=>{const{xpra:e,state:t,dispatch:n}=d.exports.useContext(T),s=t.showOptions?"Hide options":"Show options",r=(a,f)=>n({type:h.SetOption,payload:[a,f]}),i=Object.fromEntries(["CBC","CFB","CTR"].map(a=>`AES-${a}`).map(a=>[a,a])),l=[{key:"reconnect",label:"Automatically reconnect",component:R},{key:"shareSession",label:"Share Session",component:R},{key:"stealSession",label:"Steal Session",component:R},{key:"clipboard",label:"Clipboard",component:R},{key:"clipboardImages",label:"Clipboard Images",component:R},{key:"fileTransfer",label:"File Transfer",component:R},{key:"printing",label:"Printing",component:R},{key:"bell",label:"Bell",component:R},{key:"notifications",label:"Notifications",component:R},{key:"openUrl",label:"Open URLs",component:R},{key:"audio",label:"Audio",component:R},{key:"showStartMenu",label:"XDG Menu",component:R},{key:"swapKeys",label:"Swap Ctrl and Cmd key",component:R},{key:"reverseScrollX",label:"Reverse X scroll",component:R},{key:"reverseScrollY",label:"Reverse Y scroll",component:R},{key:"keyboardLayout",label:"Keyboard Layout",component:we,options:Be}].map(a=>W(g({},a),{value:t.options[a.key],onChange:f=>r(a.key,f.target.value)})),u=a=>n({type:h.SetHost,payload:a.target.value}),E=a=>r("username",a.target.value),c=a=>r("password",a.target.value),w=a=>r("encryption",a.target.value||null),b=a=>r("encryptionKey",a.target.value),y=a=>{a.preventDefault(),n({type:h.SetError,payload:""}),e.connect(t.host,t.options)},S=()=>n({type:h.SetShowOptions,payload:!t.showOptions});return o.createElement(oe,{classNames:["p-8","top-1/2","left-1/2 transform","-translate-x-1/2","-translate-y-1/2","w-11/12","max-w-xl","max-h-full","overflow-auto"]},o.createElement("form",{className:"space-y-4",onSubmit:y},o.createElement("div",{className:"space-y-2"},o.createElement(j,{required:!0,placeholder:"Host",value:t.host,onChange:u}),o.createElement("div",{className:"grid grid-cols-2 gap-2"},o.createElement(j,{placeholder:"Username",value:t.options.username,onChange:E}),o.createElement(j,{type:"password",placeholder:"Password",value:t.options.password,onChange:c}),o.createElement(we,{value:t.options.encryption||"",options:g({"":"No encryption"},i),onChange:w}),o.createElement(j,{type:"password",placeholder:"Encryption key",value:t.options.encryptionKey,onChange:b}))),t.error&&o.createElement("div",{className:"rounded border border-red-500 bg-red-300 p-2 text-red-500"},t.error),o.createElement("div",{className:"flex space-x-2"},o.createElement(X,{label:"Connect",type:"submit"}),o.createElement(X,{label:s,onClick:S})),o.createElement(B,{toggled:t.showOptions},o.createElement("div",{className:"px-2 text-sm"},l.map(O=>{var M=O,{component:a,key:f}=M,v=ce(M,["component","key"]);const C=a;return o.createElement(C,g({key:f},v))})))))},ct=()=>{const{state:e}=d.exports.useContext(T),t=[["Last server ping",e.stats.lastServerPing],["Last client echo",e.stats.lastClientEcho],["Client ping latency",e.stats.clientPingLatency],["Server ping latency",e.stats.serverPingLatency],["Server load",e.stats.serverLoad.join(" / ")],["Window count",e.windows.length]];return o.createElement("div",{className:"absolute bottom-1 left-1 z-0 rounded bg-emerald-100 p-1 opacity-50"},o.createElement("table",{className:"text-xs"},o.createElement("tbody",null,t.map(([n,s])=>o.createElement("tr",{key:n},o.createElement("td",{className:"p-1"},n),o.createElement("td",{className:"p-1 text-right text-gray-500"},s))))))},dt=()=>{const{wm:e,state:t,dispatch:n,xpra:s}=d.exports.useContext(T),[r,i]=d.exports.useState(!1),l=t.windows.filter(a=>a.minimized),u=t.windows.filter(a=>a.tray),E=[...t.menu.map(a=>({title:a.name,icon:a.icon,items:a.entries.map(f=>({title:f.name,icon:f.icon,callback:()=>{s.sendStartCommand(f.name,f.exec,!1)}}))})),{title:"Server",items:[{title:"Shutdown server",callback:()=>{confirm("Are you sure you want to shut down the server ?")&&s.sendShutdown()}}]},{title:"Windows",items:t.windows.filter(a=>!a.tray).map(a=>{var f;return{title:a.title,icon:(f=a.icon)==null?void 0:f.image,callback:()=>{const v=e.getWindow(a.id);v&&(e.raise(v),n({type:h.RaiseWindow,payload:v.attributes}))}}})},{title:"Disconnect",callback:()=>s.disconnect()}],c=a=>f=>{f.stopPropagation(),f.preventDefault();const v=e.getWindow(a.id);v&&(e.restore(v),e.raise(v),n({type:h.RaiseWindow,payload:v.attributes}))},w=()=>i(!r),b=()=>{i(!1)},y=()=>s.clipboard.poll(),S=async()=>{(await Le()).forEach(({buffer:f,name:v,size:O,type:M})=>s.sendFile(v,M,O,f))};return o.createElement(oe,{classNames:["top-1","left-1/2","-translate-x-1/2","p-1","select-none"]},o.createElement("div",{className:"flex space-x-4 px-2"},o.createElement("div",{className:"flex space-x-1"},o.createElement(X,{transparent:!0,onClick:w},o.createElement(Q,{icon:"bars",className:"pointer-events-none"}),o.createElement(B,{toggled:r},o.createElement(Se,{items:E,onCallback:b}))),t.options.clipboard&&o.createElement(X,{transparent:!0,onClick:y},o.createElement(Q,{icon:"clipboard"})),t.options.fileTransfer&&o.createElement(X,{transparent:!0,onClick:S},o.createElement(Q,{icon:"upload"}))),l.length>0&&o.createElement("div",{className:"flex space-x-1"},l.map(a=>o.createElement(X,{key:a.id,transparent:!0,onClick:c(a)},o.createElement("div",{className:"flex items-center space-x-1",style:{maxWidth:"128px"}},o.createElement("div",{className:"h-4 w-4"},o.createElement(he,{win:a})),o.createElement("div",{className:"truncate text-center text-sm"},a.title))))),u.length>0&&o.createElement("div",{className:"flex space-x-1"},u.map(a=>o.createElement("div",{key:a.id,className:"flex items-center space-x-1"},o.createElement("div",{className:"flex h-4 w-4 items-center justify-center overflow-hidden",title:a.title},o.createElement(ee,{id:a.id})))))))},mt=()=>{const{state:e,xpra:t}=d.exports.useContext(T),n=()=>t.disconnect();return o.createElement(oe,{classNames:["p-8","top-1/2","left-1/2 transform","-translate-x-1/2","-translate-y-1/2","w-96"]},o.createElement("div",{className:"space-y-4"},o.createElement("div",{className:"text-center"},"Connecting to ",e.host),o.createElement("div",null,o.createElement(X,{onClick:n},"Cancel"))))};/**
 * Xpra Typescript Client React UI
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */function ut(){const{state:e,xpra:t}=d.exports.useContext(T),n=t.getOptions().showStatistics,s=()=>Ze();return o.createElement(o.Fragment,null,o.createElement(B,{toggled:!e.connected},o.createElement(lt,null)),o.createElement(B,{toggled:!e.started&&e.connected},o.createElement(mt,null)),o.createElement(rt,null,e.connected&&n&&o.createElement(ct,null)),o.createElement(B,{toggled:e.started},o.createElement(dt,null)),o.createElement("div",{className:"fixed right-0 bottom-0 z-50 space-y-2 p-2 text-right text-xs opacity-50"},o.createElement("div",{className:"cursor-pointer underline"},o.createElement("span",{onClick:s},"Toggle dark mode")),o.createElement("div",null,o.createElement("a",{className:"underline",rel:"noreferrer",target:"_blank",href:"https://github.com/andersevenrud/xpra-html5-client"},"xpra-html5-client on Github"))))}function pt({xpra:e,wm:t}){return o.createElement(tt,{wm:t,xpra:e},o.createElement(ut,null))}function ft(){return new Worker("assets/worker.0abb01c5.js",{type:"module"})}function Et(){return new Worker("assets/decoder.90ce1009.js",{type:"module"})}/**
 * Xpra Typescript Client Example
 * @link https://github.com/andersevenrud/xpra-html5-client
 * @author Anders Evenrud <andersevenrud@gmail.com>
 * @license Mozilla Public License Version 2.0
 */async function gt(){const e=document.querySelector("#app"),t=new ft,n=new Et,s=new Ye({worker:t,decoder:n}),r=new Ve(s);await s.init(),r.init(),e&&Pe.render(d.exports.createElement(pt,{xpra:s,wm:r}),e)}window.addEventListener("DOMContentLoaded",()=>{Ke(),gt()});
//# sourceMappingURL=index.cf5e36d5.js.map
