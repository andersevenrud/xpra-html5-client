{"version":3,"file":"index.fc997ecb.js","sources":["../../vite/modulepreload-polyfill","../../src/app/utils.ts","../../src/app/store.ts","../../src/app/context.tsx","../../src/app/transitions.tsx","../../src/app/cursor.png","../../src/app/desktop.tsx","../../src/app/inputs.tsx","../../src/app/panels.tsx","../../src/app/App.tsx","../../src/main.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React from 'react'\nimport { XpraCursor, XpraWindowMetadata } from 'xpra-html5-client'\n\nexport function createCursorBackgroundCSS(cursor: XpraCursor | null) {\n  if (cursor) {\n    const { image, xhot, yhot } = cursor\n    return `transparent url('${image}') no-repeat ${xhot}px ${yhot}px`\n  }\n\n  return ''\n}\n\nexport function createCursorCSS(cursor: XpraCursor | null, defaultValue = '') {\n  if (cursor) {\n    const { image, xhot, yhot } = cursor\n    const suffix = defaultValue ? `, ${defaultValue}` : ''\n    return `url('${image}') ${xhot} ${yhot}${suffix}`\n  }\n\n  return defaultValue\n}\n\nexport function detectCorner(\n  root: HTMLElement,\n  position: [number, number],\n  size: number\n) {\n  let direction = ''\n  const { width, height, x, y } = root.getBoundingClientRect()\n  const relativeX = position[0] - x\n  const relativeY = position[1] - y\n\n  if (relativeY <= size) {\n    direction += 'n'\n  } else if (relativeY >= height - size) {\n    direction += 's'\n  }\n\n  if (relativeX <= size) {\n    direction += 'w'\n  } else if (relativeX >= width - size) {\n    direction += 'e'\n  }\n\n  return direction\n}\n\nexport function useDrag(\n  callback: () => {\n    onDown?: (ev: MouseEvent, startX: number, startY: number) => void\n    onMove: (ev: MouseEvent, diffX: number, diffY: number) => void\n    onRelease: (ev: MouseEvent, moved: boolean) => void\n  }\n) {\n  const { onDown, onMove, onRelease } = callback()\n  return (ev: React.MouseEvent<HTMLElement>) => {\n    ev.preventDefault()\n\n    const startX = ev.pageX\n    const startY = ev.pageY\n    let moved = false\n\n    const onMouseMove = (ev: MouseEvent) => {\n      ev.stopPropagation()\n      const diffX = ev.pageX - startX\n      const diffY = ev.pageY - startY\n      moved = true\n      onMove(ev, diffX, diffY)\n    }\n\n    const onMouseUp = (ev: MouseEvent) => {\n      window.removeEventListener('mousemove', onMouseMove, true)\n      window.removeEventListener('mouseup', onMouseUp, true)\n      onRelease(ev, moved)\n    }\n\n    window.addEventListener('mousemove', onMouseMove, true)\n    window.addEventListener('mouseup', onMouseUp, true)\n\n    if (onDown) {\n      onDown(ev.nativeEvent, startX, startY)\n    }\n  }\n}\n\nexport function createOpacity({\n  opacity,\n}: Partial<XpraWindowMetadata>): number | undefined {\n  if (typeof opacity === 'number') {\n    return opacity < 0 ? 1 : opacity / 0x100000000\n  }\n\n  return undefined\n}\n","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport { ActionMap, ValueOf } from './types'\nimport { createOpacity } from './utils'\nimport {\n  XpraWindow,\n  XpraWindowIcon,\n  XpraConnectionStats,\n  XpraWindowMoveResize,\n  XpraWindowMetadataUpdate,\n  XpraCursor,\n  XpraNotification,\n  XpraVector,\n  XpraConnectionOptions,\n  XpraXDGReducedMenu,\n  createDefaultXpraConnectionOptions,\n  initialXpraConnectionStats,\n  createXpraWindowBaseZindex,\n} from 'xpra-html5-client'\n\nexport interface AppWindowState {\n  id: number\n  title: string\n  minimized: boolean\n  maximized: boolean\n  position: XpraVector\n  dimension: XpraVector\n  icon?: XpraWindowIcon\n  zIndex: number\n  tray: boolean\n  opacity?: number\n  maxDimension?: XpraVector\n  minDimension?: XpraVector\n  oldPosition?: XpraVector\n  oldDimension?: XpraVector\n}\n\nexport interface AppState {\n  connect: boolean\n  host: string\n  showOptions: boolean\n  connected: boolean\n  cursor: XpraCursor | null\n  stats: XpraConnectionStats\n  windows: AppWindowState[]\n  draggingWindow: number\n  activeWindow: number\n  notifications: [XpraNotification, Notification | null][]\n  actualDesktopSize: XpraVector\n  options: XpraConnectionOptions\n  menu: XpraXDGReducedMenu\n  error: string\n  started: boolean\n}\n\nexport interface AppMaximizeWindow {\n  wid: number\n  position?: XpraVector\n  dimension?: XpraVector\n  maximize: boolean\n}\n\nexport enum ActionTypes {\n  SetHost = 'SET_HOST',\n  SetShowOptions = 'SET_SHOW_OPTIONS',\n  AddWindow = 'ADD_WINDOW',\n  RemoveWindow = 'REMOVE_WINDOW',\n  SetWindowIcon = 'SET_WINDOW_ICON',\n  SetConnected = 'SET_CONNECTED',\n  SetCursor = 'SET_CURSOR',\n  UpdateStats = 'UPDATE_STATS',\n  MoveResizeWindow = 'MOVE_RESIZE_WINDOW',\n  MaximizeWindow = 'MAXIMIZE_WINDOW',\n  UpdateMetadata = 'UPDATE_METADATA',\n  RaiseWindow = 'RAISE_WINDOW',\n  AddNotification = 'ADD_NOTIFICATION',\n  RemoveNotification = 'REMOVE_NOTIFICATION,',\n  SetDraggingWindow = 'SET_DRAGGING_WINDOW',\n  ClearWindows = 'CLEAR_WINDOWS',\n  SetOption = 'SET_OPTION',\n  UpdateMenu = 'UPDATE_MENU',\n  SetError = 'SET_ERROR',\n  SetStarted = 'SET_STARTED',\n}\n\nexport type AppStatePayload = {\n  [ActionTypes.SetHost]: string\n  [ActionTypes.SetShowOptions]: boolean\n  [ActionTypes.AddWindow]: XpraWindow\n  [ActionTypes.RemoveWindow]: number\n  [ActionTypes.SetWindowIcon]: XpraWindowIcon\n  [ActionTypes.SetConnected]: boolean\n  [ActionTypes.SetCursor]: XpraCursor | null\n  [ActionTypes.UpdateStats]: XpraConnectionStats\n  [ActionTypes.MoveResizeWindow]: XpraWindowMoveResize\n  [ActionTypes.MaximizeWindow]: AppMaximizeWindow\n  [ActionTypes.UpdateMetadata]: XpraWindowMetadataUpdate\n  [ActionTypes.RaiseWindow]: XpraWindow\n  [ActionTypes.AddNotification]: [XpraNotification, Notification | null]\n  [ActionTypes.RemoveNotification]: number\n  [ActionTypes.SetDraggingWindow]: number\n  [ActionTypes.ClearWindows]: undefined\n  [ActionTypes.SetOption]: [\n    keyof XpraConnectionOptions,\n    ValueOf<XpraConnectionOptions>\n  ]\n  [ActionTypes.UpdateMenu]: XpraXDGReducedMenu\n  [ActionTypes.SetError]: string\n  [ActionTypes.SetStarted]: boolean\n}\n\nexport type AppStateActions =\n  ActionMap<AppStatePayload>[keyof ActionMap<AppStatePayload>]\n\nlet lastZindex = 1\n\nexport const initialState: AppState = {\n  connect: false,\n  host: 'ws://127.0.0.1:10000',\n  showOptions: false,\n  connected: false,\n  cursor: null,\n  windows: [],\n  notifications: [],\n  activeWindow: 0,\n  draggingWindow: -1,\n  actualDesktopSize: [0, 0],\n  stats: { ...initialXpraConnectionStats },\n  options: { ...createDefaultXpraConnectionOptions() },\n  menu: [],\n  error: '',\n  started: false,\n}\n\nexport function stateReducer(state: AppState, action: AppStateActions) {\n  const newWindowState = (\n    wid: number,\n    append: (data: AppWindowState) => Partial<AppWindowState>\n  ) => {\n    const windows = state.windows\n    const found = windows.find((w) => w.id === wid)\n    if (found) {\n      Object.assign(found, append(found))\n    }\n\n    return {\n      ...state,\n      windows,\n    }\n  }\n\n  switch (action.type) {\n    case ActionTypes.SetHost:\n      return {\n        ...state,\n        host: action.payload,\n      }\n\n    case ActionTypes.SetShowOptions:\n      return {\n        ...state,\n        showOptions: action.payload,\n      }\n\n    case ActionTypes.AddWindow:\n      const isTray = !!action.payload.metadata.tray\n      return {\n        ...state,\n        activeWindow: action.payload.id,\n        windows: [\n          ...state.windows,\n          {\n            id: action.payload.id,\n            minimized: action.payload.metadata.iconic === true,\n            maximized: false,\n            title: action.payload.metadata.title || String(action.payload.id),\n            position: action.payload.position,\n            dimension: action.payload.dimension,\n            minDimension:\n              action.payload.metadata['size-constraints']?.['minimum-size'],\n            maxDimension:\n              action.payload.metadata['size-constraints']?.['maximum-size'],\n            opacity: createOpacity(action.payload.metadata),\n            tray: isTray,\n            zIndex: isTray\n              ? 0\n              : createXpraWindowBaseZindex(action.payload, ++lastZindex),\n          },\n        ],\n      }\n\n    case ActionTypes.RemoveWindow:\n      const { windows } = state\n      const foundIndex = windows.findIndex((w) => w.id === action.payload)\n      if (foundIndex !== -1) {\n        windows.splice(foundIndex, 1)\n      }\n\n      const nextActiveWindow =\n        windows.length > 0 ? windows[windows.length - 1].id : 0\n\n      return {\n        ...state,\n        activeWindow: nextActiveWindow,\n        windows,\n      }\n\n    case ActionTypes.SetWindowIcon:\n      const icon = action.payload\n      return newWindowState(icon.wid, () => ({ icon }))\n\n    case ActionTypes.SetConnected:\n      return {\n        ...state,\n        started: false,\n        windows: action.payload ? state.windows : [],\n        connected: action.payload,\n      }\n\n    case ActionTypes.SetCursor:\n      return {\n        ...state,\n        cursor: action.payload,\n      }\n\n    case ActionTypes.UpdateStats:\n      return {\n        ...state,\n        stats: {\n          ...state.stats,\n          ...action.payload,\n        },\n      }\n\n    case ActionTypes.MoveResizeWindow:\n      const { wid, position, dimension } = action.payload\n      return newWindowState(wid, (win) => ({\n        position: position || win.position,\n        dimension: dimension || win.dimension,\n      }))\n\n    case ActionTypes.MaximizeWindow:\n      const { maximize } = action.payload\n      return newWindowState(action.payload.wid, (win) => ({\n        oldPosition: maximize ? win.position : undefined,\n        oldDimension: maximize ? win.dimension : undefined,\n        position: maximize ? action.payload.position : win.oldPosition,\n        dimension: maximize ? action.payload.dimension : win.oldDimension,\n        maximized: maximize,\n      }))\n\n    case ActionTypes.UpdateMetadata:\n      const { title, iconic } = action.payload.metadata\n\n      return newWindowState(action.payload.wid, (win) => ({\n        opacity: createOpacity(action.payload.metadata),\n        minimized: iconic === undefined ? win.minimized : iconic === true,\n        title: title === undefined ? win.title : title,\n      }))\n\n    case ActionTypes.RaiseWindow:\n      return {\n        ...newWindowState(action.payload.id, () => ({\n          zIndex: createXpraWindowBaseZindex(action.payload, ++lastZindex),\n        })),\n        activeWindow: action.payload.id,\n      }\n\n    case ActionTypes.AddNotification:\n      return {\n        ...state,\n        notifications: [...state.notifications, action.payload],\n      }\n\n    case ActionTypes.RemoveNotification:\n      const { notifications } = state\n      const foundNotificationIndex = notifications.findIndex(\n        ([n]) => n.id === action.payload\n      )\n\n      if (foundNotificationIndex !== -1) {\n        notifications.splice(foundNotificationIndex, 1)\n      }\n\n      return { ...state, notifications }\n\n    case ActionTypes.SetDraggingWindow:\n      return {\n        ...state,\n        draggingWindow: action.payload,\n      }\n\n    case ActionTypes.ClearWindows:\n      return {\n        ...state,\n        cursor: null,\n        windows: [],\n        notifications: [],\n        draggingWindow: -1,\n      }\n\n    case ActionTypes.SetOption:\n      const [key, value] = action.payload\n\n      return {\n        ...state,\n        options: {\n          ...state.options,\n          [key]: value,\n        },\n      }\n\n    case ActionTypes.UpdateMenu:\n      return {\n        ...state,\n        menu: action.payload,\n      }\n\n    case ActionTypes.SetError:\n      return {\n        ...state,\n        error: action.payload,\n      }\n\n    case ActionTypes.SetStarted:\n      return {\n        ...state,\n        started: action.payload,\n      }\n\n    default:\n      return state\n  }\n}\n","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React, {\n  useEffect,\n  useReducer,\n  useState,\n  createContext,\n  FC,\n  Dispatch,\n} from 'react'\nimport {\n  XpraClient,\n  XpraWindow,\n  XpraWindowIcon,\n  XpraConnectionStats,\n  XpraWindowMoveResize,\n  XpraWindowMetadataUpdate,\n  XpraCursor,\n  XpraWindowManager,\n  XpraNotification,\n  XpraWindowInitiateMoveResize,\n  XpraConnectionStatus,\n  XpraPointerPosition,\n  XpraXDGReducedMenu,\n  createXpraConnectionOptionsFromUrl,\n  parseUrlQuerySearch,\n} from 'xpra-html5-client'\nimport {\n  ActionTypes,\n  AppState,\n  AppStateActions,\n  initialState,\n  stateReducer,\n} from './store'\n\nexport type AppContextProps = {\n  xpra: XpraClient\n  wm: XpraWindowManager\n}\n\nexport const AppContext = createContext<{\n  wm: XpraWindowManager\n  xpra: XpraClient\n  state: AppState\n  root: HTMLElement | null\n  dispatch: Dispatch<AppStateActions>\n  setRoot: Dispatch<HTMLElement | null>\n  setCursor: Dispatch<HTMLElement | null>\n}>({\n  /* eslint-disable @typescript-eslint/no-non-null-assertion */\n  wm: null!,\n  xpra: null!,\n  state: initialState,\n  root: null,\n  setRoot: () => {\n    /*placeholder*/\n  },\n  setCursor: () => {\n    /*placeholder*/\n  },\n  dispatch: () => {\n    /*placeholder */\n  },\n})\n\nconst otherOptions = parseUrlQuerySearch<{\n  connect: boolean\n  host: string\n}>(['connect'], [], ['connect', 'host'])\n\nconst createdOptions = createXpraConnectionOptionsFromUrl()\n\nconst initialCreatedState = {\n  ...initialState,\n  ...otherOptions,\n  options: {\n    ...initialState.options,\n    ...createdOptions,\n  },\n}\n\nexport const AppContextProvider: FC<AppContextProps> = ({\n  children,\n  wm,\n  xpra,\n}) => {\n  const [state, dispatch] = useReducer(stateReducer, initialCreatedState)\n  const [root, setRoot] = useState<HTMLElement | null>(null)\n  const [cursor, setCursor] = useState<HTMLElement | null>(null)\n\n  const setConnected = () => {\n    dispatch({\n      type: ActionTypes.SetConnected,\n      payload: true,\n    })\n\n    dispatch({\n      type: ActionTypes.SetError,\n      payload: '',\n    })\n  }\n\n  const setDisconnected = (s: XpraConnectionStatus) => {\n    dispatch({\n      type: ActionTypes.SetConnected,\n      payload: s !== 'disconnected',\n    })\n    dispatch({\n      type: ActionTypes.ClearWindows,\n    })\n  }\n\n  const addWindow = (attributes: XpraWindow) =>\n    dispatch({\n      type: ActionTypes.AddWindow,\n      payload: attributes,\n    })\n\n  const removeWindow = (wid: number) =>\n    dispatch({\n      type: ActionTypes.RemoveWindow,\n      payload: wid,\n    })\n\n  const addWindowIcon = (icon: XpraWindowIcon) =>\n    dispatch({\n      type: ActionTypes.SetWindowIcon,\n      payload: icon,\n    })\n\n  const updateStats = (stats: XpraConnectionStats) =>\n    dispatch({\n      type: ActionTypes.UpdateStats,\n      payload: stats,\n    })\n\n  const updateCursor = (cursor: XpraCursor | null) =>\n    dispatch({\n      type: ActionTypes.SetCursor,\n      payload: cursor,\n    })\n\n  const resizeMoveWindow = (data: XpraWindowMoveResize) =>\n    dispatch({\n      type: ActionTypes.MoveResizeWindow,\n      payload: data,\n    })\n\n  const raiseWindow = (wid: number) => {\n    const win = wm.getWindow(wid)\n    if (win) {\n      dispatch({\n        type: ActionTypes.RaiseWindow,\n        payload: win.attributes,\n      })\n    }\n  }\n\n  const updateMetadata = (data: XpraWindowMetadataUpdate) =>\n    dispatch({\n      type: ActionTypes.UpdateMetadata,\n      payload: data,\n    })\n\n  const initiateMoveResize = (_: XpraWindowInitiateMoveResize) => {\n    /* TODO: Implement */\n  }\n\n  const showNotification = async (notif: XpraNotification) =>\n    dispatch({\n      type: ActionTypes.AddNotification,\n      payload: [notif, await wm.createNotification(notif)],\n    })\n\n  const hideNotification = (nid: number) =>\n    dispatch({\n      type: ActionTypes.RemoveNotification,\n      payload: nid,\n    })\n\n  const pointerPosition = (pointer: XpraPointerPosition) => {\n    if (cursor) {\n      const [x, y] = pointer.position\n      Object.assign(cursor.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      })\n    }\n  }\n\n  const setError = (error: string) =>\n    dispatch({\n      type: ActionTypes.SetError,\n      payload: error,\n    })\n\n  const updateMenu = (payload: XpraXDGReducedMenu) =>\n    dispatch({\n      type: ActionTypes.UpdateMenu,\n      payload,\n    })\n\n  const sessionStarted = () =>\n    dispatch({\n      type: ActionTypes.SetStarted,\n      payload: true,\n    })\n\n  useEffect(() => {\n    xpra.on('connect', setConnected)\n    xpra.on('disconnect', setDisconnected)\n    xpra.on('newWindow', addWindow)\n    xpra.on('removeWindow', removeWindow)\n    xpra.on('windowIcon', addWindowIcon)\n    xpra.on('pong', updateStats)\n    xpra.on('cursor', updateCursor)\n    xpra.on('moveResizeWindow', resizeMoveWindow)\n    xpra.on('updateWindowMetadata', updateMetadata)\n    xpra.on('raiseWindow', raiseWindow)\n    xpra.on('initiateMoveResize', initiateMoveResize)\n    xpra.on('showNotification', showNotification)\n    xpra.on('hideNotification', hideNotification)\n    xpra.on('pointerPosition', pointerPosition)\n    xpra.on('newTray', addWindow)\n    xpra.on('updateXDGMenu', updateMenu)\n    xpra.on('error', setError)\n    xpra.on('sessionStarted', sessionStarted)\n\n    return () => {\n      xpra.off('connect', setConnected)\n      xpra.off('disconnect', setDisconnected)\n      xpra.off('newWindow', addWindow)\n      xpra.off('removeWindow', removeWindow)\n      xpra.off('windowIcon', addWindowIcon)\n      xpra.off('pong', updateStats)\n      xpra.off('cursor', updateCursor)\n      xpra.off('moveResizeWindow', resizeMoveWindow)\n      xpra.off('updateWindowMetadata', updateMetadata)\n      xpra.off('raiseWindow', raiseWindow)\n      xpra.off('initiateMoveResize', initiateMoveResize)\n      xpra.off('showNotification', showNotification)\n      xpra.off('hideNotification', hideNotification)\n      xpra.off('pointerPosition', pointerPosition)\n      xpra.off('newTray', addWindow)\n      xpra.off('updateXDGMenu', updateMenu)\n      xpra.off('error', setError)\n      xpra.off('sessionStarted', sessionStarted)\n    }\n  }, [])\n\n  useEffect(() => {\n    if (state.connect) {\n      xpra.connect(state.host, state.options)\n    }\n  }, [])\n\n  useEffect(() => {\n    wm.setDesktopElement(root)\n  }, [root])\n\n  useEffect(() => {\n    wm.setActiveWindow(state.activeWindow)\n  }, [state.activeWindow])\n\n  return (\n    <AppContext.Provider\n      value={{ state, dispatch, root, wm, xpra, setRoot, setCursor }}\n    >\n      {children}\n    </AppContext.Provider>\n  )\n}\n","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React, { FC } from 'react'\nimport { CSSTransition } from 'react-transition-group'\n\nconst duration = 300\n\nexport const FadeInOutTransition: FC<{\n  toggled: boolean\n  mountOnEnter?: boolean\n  unmountOnExit?: boolean\n}> = ({ toggled, children, mountOnEnter = true, unmountOnExit = true }) => {\n  return (\n    <CSSTransition\n      in={toggled}\n      timeout={duration}\n      mountOnEnter={mountOnEnter}\n      unmountOnExit={unmountOnExit}\n      classNames=\"fade-on-out\"\n    >\n      {children}\n    </CSSTransition>\n  )\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAASdAAAEnQB3mYfeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAUdEVYdEF1dGhvcgBKYWt1YiBTdGVpbmVy5vv3LwAAADV0RVh0RGVzY3JpcHRpb24ASW52ZXJ0ZWQgdmFyaWFudCBvZiB0aGUgRE1aIGN1cnNvciB0aGVtZS5odVs8AAAAM3RFWHRTb3VyY2UAaHR0cDovL2ppbW1hYy5tdXNpY2hhbGwuY3ovdGhlbWVzLnBocD9za2luPTdQM5WxAAADwUlEQVRYhe2WTUhsZRjHf+PVcdLU48d1GkMvdwI185ZIzEYpaKttWqhcKhlFF65USjcK6equNFJbCEokiISiochQgfmBaI6CKGmg5MeIwpBXZpIRPec8LWb0Wte6c1SsRX94eDcvvD+er/8L/+sFEpFX/833o3Vd9zc3N78FxAIRdw0QKyISCAT8xcXFDuDlu4aIl5D8fr+voKDgbe44E/EiIu3t7eL3+8Xn8x3l5ua+GYIw3RlAeXm5FBUVSSAQEJ/Pd2i32x8BMbcBEVYqdV1nfn4ep9OJxWJJXFpa+t5msz0AXropRFgAmqahqiqTk5NUVVURGxtrXV1ddQFpgOUmEIYAVFVlYmKCuro6FEXJ8Hq93wE2IPq6EGEBiMgFgKqquFwuGhoaSE5Ofri/v/8t8Mp1IcIep8sAqqoyPj5Oa2srVqs1d29vbwiwAmajENcGUFWV4eFh2traSEtLy9/Z2fkGSDUKYWihXAUxMDBAZ2cn6enpjo2Nja+A+0YgDANcbsjz6O/vp6+vD7vd/t7a2tqXQAoQFQ6EIYC/NuPl6OnpYXBwkKysrPdXVla+CBfC8E6/6vHzrHR3dzM8PExOTs4HCwsLT4BkIPKfICKNAlwuAYDD4cBisWA2m4mOjmZxcZG8vDzy8/M/mpmZ+b2wsPAz4ClwZvQtCHlBSUmJABcRGRkpcXFxYrVaxe12y99J13WZnp5+Aii3lgGAsrIyxsbGUFWVrq4uent76ejo+GFoaOgns9l8bDKZxGQy6WazOSAivxJcUtfScxmora0VXdelpqZGEhISxGazyebmpni93qdAEfA6YAceAg8ILqiYWwFoaGgQXdfl9PRU9Xg8oiiKpKSkSH19vWiaJk1NTY0EvcEM3AtFBDcwqwuAxsZGERFZXFxcdzqdn2uaJtXV1aIoimRkZMjBwYEcHBx4gDe4oUM+BzA3Nye6rsvs7OwK8DFQcHR05Nna2hJFUSQ1NVVaWlpEVVWprKysIDh+t/Jtiz/v5qmpqSXgQ+ARkDw6OvpY0zSpqKiQpKQkyczMlOPjY1leXp4DXiO4hG4HYH5+/kegDMgF4ghOj+L3+/c2NjYkMTFRsrOz5fDwUNbX138OQd5KGWJ3d3e/Bt4Bsnn2LTcBUS6X6/HZ2Zlsb29LIBCQk5MTvbS0tCV017A1X6UoIJGgw8Xw57qagPiRkZFPPB7PL2632+1wOD4F3iXoA2H1wIsITQRHSQA9dF7WPYIluU/wg3oC/Ab4APWK+4YBwlEEz2ZeC8X54vrv6w+aYEf+AZkZtAAAAABJRU5ErkJggg==\"","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React, {\n  useEffect,\n  useContext,\n  useState,\n  useRef,\n  useCallback,\n  createRef,\n  RefObject,\n  FC,\n} from 'react'\nimport { throttle } from 'lodash-es'\nimport {\n  createCursorCSS,\n  createCursorBackgroundCSS,\n  useDrag,\n  detectCorner,\n} from './utils'\nimport { ActionTypes, AppWindowState } from './store'\nimport { XpraWindowManagerWindow, XpraVector } from 'xpra-html5-client'\nimport { FadeInOutTransition } from './transitions'\nimport { AppContext } from './context'\nimport defaultCursor from './cursor.png'\n\nexport const DRAG_CORNER_SIZE = 16\n\nlet isDragging = false\n\n/**\n * Window Buttons Component\n */\nexport const AppWindowButtons: FC<{\n  winstance: XpraWindowManagerWindow\n  win: AppWindowState\n  bar: RefObject<HTMLDivElement>\n  outer: RefObject<HTMLDivElement>\n}> = ({ win, bar, winstance }) => {\n  const { oldPosition, oldDimension } = win\n  const { wm, xpra, root, dispatch } = useContext(AppContext)\n  const buttonClassNames =\n    'w-4 h-4 rounded-full cursor-pointer bg-gradient-to-b shadow-inner hover:shadow'\n\n  const onMouseDown = (ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.stopPropagation()\n    ev.preventDefault()\n  }\n\n  const onMaximize = () => {\n    if (bar.current && root) {\n      if (win.maximized) {\n        if (oldPosition && oldDimension) {\n          wm.maximize(winstance, oldPosition, oldDimension)\n\n          dispatch({\n            type: ActionTypes.MaximizeWindow,\n            payload: {\n              wid: win.id,\n              maximize: false,\n            },\n          })\n        }\n      } else {\n        const x = 0\n        const y = bar.current.offsetHeight\n        const w = root.offsetWidth\n        const h = root.offsetHeight - y\n\n        wm.maximize(winstance, [x, y], [w, h])\n\n        dispatch({\n          type: ActionTypes.MaximizeWindow,\n          payload: {\n            wid: win.id,\n            position: [x, y],\n            dimension: [w, h],\n            maximize: true,\n          },\n        })\n      }\n    }\n  }\n\n  return (\n    <div className=\"flex items-center space-x-2\" onMouseDown={onMouseDown}>\n      <div\n        title=\"Minimize\"\n        className={`${buttonClassNames} from-green-300 to-green-500 hover:from-green-400`}\n        onClick={() => wm.minimize(winstance)}\n      />\n      <div\n        title=\"Maximize\"\n        className={`${buttonClassNames} from-blue-300 to-blue-500 hover:from-blue-400`}\n        onClick={onMaximize}\n      />\n      {!xpra.isReadOnly() && (\n        <div\n          title=\"Close\"\n          className={`${buttonClassNames} from-red-300 to-red-500 hover:from-red-400`}\n          onClick={() => wm.close(winstance)}\n        />\n      )}\n    </div>\n  )\n}\n\nexport const AppWindowIcon: FC<{ win: AppWindowState }> = ({\n  win: { icon, title },\n}) => {\n  return (\n    <>\n      {icon && <img alt={title} src={icon.image} className=\"max-h-full\" />}\n      {!icon && <div className=\"w-full h-full bg-gray-500 rounded\" />}\n    </>\n  )\n}\n\n/**\n * Window canvas Component\n */\nexport const AppWindowCanvas: FC<{\n  id: number\n}> = ({ id }) => {\n  const root = useRef<HTMLDivElement | null>(null)\n  const { wm, state } = useContext(AppContext)\n  const winstance = wm.getWindow(id) as XpraWindowManagerWindow\n\n  const canvasClassNames =\n    state.draggingWindow >= 0 ? 'pointer-events-none' : ''\n\n  const onMouseDown = (ev: React.MouseEvent<HTMLDivElement>) => {\n    wm.mouseButton(winstance, ev.nativeEvent, true)\n  }\n\n  const onMouseUp = (ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.stopPropagation()\n    wm.mouseButton(winstance, ev.nativeEvent, false)\n  }\n\n  const onMouseMove = (ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.preventDefault()\n    ev.stopPropagation()\n    wm.mouseMove(winstance, ev.nativeEvent)\n  }\n\n  useEffect(() => {\n    if (root.current) {\n      root.current.appendChild(winstance.canvas)\n    }\n  }, [root.current])\n\n  return (\n    <div\n      ref={root}\n      className={canvasClassNames}\n      onMouseDown={onMouseDown}\n      onMouseUp={onMouseUp}\n      onMouseMove={onMouseMove}\n    />\n  )\n}\n\n/**\n * Window Component\n */\nexport const AppWindow: FC<{ win: AppWindowState }> = ({ win }) => {\n  const {\n    id,\n    position,\n    dimension,\n    title,\n    minimized,\n    maximized,\n    opacity,\n    zIndex,\n    minDimension,\n    maxDimension,\n  } = win\n\n  const [resizeCursor, setResizeCursor] = useState<string>('default')\n  const { wm, dispatch, xpra } = useContext(AppContext)\n  const root = useRef<HTMLDivElement | null>(null)\n  const bar = useRef<HTMLDivElement | null>(null)\n  const resizer = useRef<HTMLDivElement | null>(null)\n  const winstance = wm.getWindow(id) as XpraWindowManagerWindow\n\n  const style = {\n    opacity,\n    zIndex,\n  }\n\n  const resizerStyle = {\n    cursor: resizeCursor,\n  }\n\n  const transitionParams = {\n    toggled: !minimized,\n    mountOnEnter: false,\n    unmountOnExit: false,\n  }\n\n  const setSizeFromAction = (\n    x: number,\n    y: number,\n    w: number,\n    h: number,\n    store = false\n  ) => {\n    if (root.current) {\n      Object.assign(root.current.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n        width: `${w}px`,\n        height: `${h}px`,\n      })\n    }\n\n    if (winstance?.canvas) {\n      Object.assign(winstance.canvas.style, {\n        width: `${w}px`,\n        height: `${h}px`,\n      })\n    }\n\n    if (store) {\n      dispatch({\n        type: ActionTypes.MoveResizeWindow,\n        payload: {\n          wid: id,\n          position: [x, y],\n          dimension: [w, h],\n        },\n      })\n    }\n  }\n\n  const setSizeFromStore = (store = false) => {\n    const [x, y] = position\n    const [w, h] = dimension\n    setSizeFromAction(x, y, w, h, store)\n  }\n\n  const roundValues =\n    (\n      cb: (x: number, y: number, w: number, h: number, moved?: boolean) => void\n    ) =>\n    (x: number, y: number, w: number, h: number, moved?: boolean) => {\n      const [minW, minH] = minDimension || [100, 100]\n      const [maxW, maxH] = maxDimension || [Number.MAX_VALUE, Number.MAX_VALUE]\n\n      w = Math.min(maxW, Math.max(minW, w))\n      h = Math.min(maxH, Math.max(minH, h))\n      // x = Math.max(0, x)\n      // y = Math.max(0, y)\n\n      cb(x, y, w, h, moved)\n    }\n\n  const dragMoveMove = roundValues(\n    (x: number, y: number, w: number, h: number) => {\n      if (!xpra.isReadOnly() && !maximized) {\n        setSizeFromAction(x, y, w, h)\n      }\n\n      setDragging(true)\n    }\n  )\n\n  const dragMoveRelease = roundValues(\n    (x: number, y: number, w: number, h: number, moved?: boolean) => {\n      setDragging(false)\n\n      if (!xpra.isReadOnly() && !maximized) {\n        setSizeFromAction(x, y, w, h, true)\n\n        if (moved) {\n          wm.moveResize(winstance, [x, y], [w, h])\n        }\n      }\n    }\n  )\n\n  const setDragging = (value: boolean) => {\n    if (!value || !isDragging) {\n      dispatch({\n        type: ActionTypes.SetDraggingWindow,\n        payload: value ? id : -1,\n      })\n    }\n\n    isDragging = value\n  }\n\n  const onRootMouseDown = (ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.preventDefault()\n    ev.stopPropagation()\n\n    wm.raise(winstance)\n\n    dispatch({\n      type: ActionTypes.RaiseWindow,\n      payload: winstance.attributes,\n    })\n  }\n\n  const onRootMouseMove = throttle((ev: React.MouseEvent<HTMLDivElement>) => {\n    if (resizer.current) {\n      const corner = detectCorner(\n        resizer.current,\n        [ev.pageX, ev.pageY],\n        DRAG_CORNER_SIZE\n      )\n      setResizeCursor(`${corner}-resize`)\n    } else {\n      setResizeCursor('default')\n    }\n  }, 100)\n\n  const onDragMouseDown = useCallback(\n    useDrag(() => {\n      const [w, h] = dimension\n      let [newX, newY] = position\n      let minY = 0\n\n      return {\n        onDown() {\n          minY = bar.current?.offsetHeight || 0\n        },\n        onMove(_, diffX, diffY) {\n          newX = position[0] + diffX\n          newY = Math.max(minY, position[1] + diffY)\n\n          dragMoveMove(newX, newY, w, h)\n          setDragging(true)\n        },\n        onRelease(_, moved) {\n          dragMoveRelease(newX, newY, w, h, moved)\n        },\n      }\n    }),\n    [position, dimension]\n  )\n\n  const onResizeMouseDown = useCallback(\n    useDrag(() => {\n      let corner = ''\n      let minY = 0\n      let [newX, newY] = position\n      let [newW, newH] = dimension\n\n      return {\n        onDown(ev, startX, startY) {\n          ev.stopPropagation()\n\n          if (resizer.current) {\n            corner = detectCorner(\n              resizer.current,\n              [startX, startY],\n              DRAG_CORNER_SIZE\n            )\n\n            minY = bar.current?.offsetHeight || 0\n          }\n        },\n\n        onMove(_, diffX, diffY) {\n          if (corner.startsWith('n')) {\n            newY = position[1] + diffY\n            if (newY > minY) {\n              newH = dimension[1] - diffY\n            } else {\n              newY = minY\n            }\n          } else if (corner.startsWith('s')) {\n            newH = dimension[1] + diffY\n          }\n\n          if (corner.endsWith('w')) {\n            newW = dimension[0] - diffX\n            newX = position[0] + diffX\n          } else if (corner.endsWith('e')) {\n            newW = dimension[0] + diffX\n          }\n\n          dragMoveMove(newX, newY, newW, newH)\n        },\n        onRelease(_, moved) {\n          dragMoveRelease(newX, newY, newW, newH, moved)\n        },\n      }\n    }),\n    [resizer, position, dimension]\n  )\n\n  useEffect(() => {\n    setSizeFromStore()\n  }, [position, dimension])\n\n  useEffect(() => {\n    setSizeFromStore()\n  }, [root])\n\n  useEffect(() => {\n    if (winstance?.attributes?.overrideRedirect) {\n      return\n    }\n\n    const [x, y] = position\n    const [w, h] = dimension\n\n    if (!xpra.isReadOnly()) {\n      const minY = bar.current?.offsetHeight || 0\n      // TODO: Clamp position in all directions\n      if (x <= 0 || y <= minY) {\n        const newX = 100\n        const newY = minY\n\n        wm.moveResize(winstance, [newX, newY], [w, h])\n        setSizeFromAction(newX, newY, w, h, true)\n      }\n    }\n  }, [])\n\n  if (winstance?.attributes?.overrideRedirect) {\n    return (\n      <FadeInOutTransition {...transitionParams}>\n        <div\n          className=\"absolute bg-black cursor-default shadow\"\n          ref={root}\n          style={style}\n          onMouseDown={onRootMouseDown}\n        >\n          <AppWindowCanvas id={id} />\n        </div>\n      </FadeInOutTransition>\n    )\n  }\n\n  return (\n    <FadeInOutTransition {...transitionParams}>\n      <div\n        ref={root}\n        style={style}\n        className=\"absolute\"\n        onMouseDown={onRootMouseDown}\n        onMouseMove={onRootMouseMove}\n      >\n        <div\n          ref={resizer}\n          className=\"absolute z-10 -left-2 -top-10 -bottom-2 -right-2\"\n          style={resizerStyle}\n          onMouseDown={onResizeMouseDown}\n        />\n\n        <div className=\"relative w-full h-full z-20 outline outline-1 outline-gray-200 shadow-xl\">\n          <div\n            className=\"absolute -top-8 w-full flex items-center p-1 px-2 h-8 space-x-2 outline outline-1 outline-gray-200 bg-gray-100 cursor-default\"\n            ref={bar}\n            onMouseDown={onDragMouseDown}\n          >\n            <div\n              className=\"flex items-center justify-center\"\n              style={{ width: '16px', height: '16px' }}\n            >\n              <AppWindowIcon win={win} />\n            </div>\n            <div className=\"flex-grow truncate text-sm\">\n              <span>{title || id}</span>\n            </div>\n            <AppWindowButtons\n              winstance={winstance}\n              win={win}\n              bar={bar}\n              outer={root}\n            />\n          </div>\n\n          <div className=\"xpra-window-canvas w-full h-full bg-black\">\n            <AppWindowCanvas id={id} />\n          </div>\n        </div>\n      </div>\n    </FadeInOutTransition>\n  )\n}\n\n/**\n * Desktop Component\n */\nexport const AppDesktop: FC = ({ children }) => {\n  const root = createRef<HTMLDivElement>()\n  const cursor = createRef<HTMLDivElement>()\n  const { wm, state, setRoot, setCursor } = useContext(AppContext)\n\n  const onMouseMove = throttle((ev: React.MouseEvent<HTMLDivElement>) => {\n    wm.mouseMove(null, ev.nativeEvent)\n  }, 200)\n\n  const onContextMenu = (ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.preventDefault()\n  }\n\n  const onMouseDown = useCallback((ev) => {\n    wm.mouseButton(null, ev, true)\n  }, [])\n\n  const onMouseUp = useCallback((ev) => {\n    wm.mouseButton(null, ev, false)\n  }, [])\n\n  const sharedCursor = {\n    dimension: [32, 32] as XpraVector,\n    xhot: 8,\n    yhot: 3,\n    image: defaultCursor,\n    ...(state.cursor || {}),\n  }\n\n  const style = `\n.xpra-cursor {\n  background: ${createCursorBackgroundCSS(sharedCursor)};\n}\n\n.xpra-window-canvas {\n  cursor: ${createCursorCSS(state.cursor, 'default')};\n}\n`\n\n  const windows = state.windows.filter((w) => !w.tray)\n\n  useEffect(() => {\n    if (root.current) {\n      setRoot(root.current)\n    }\n  }, [root.current])\n\n  useEffect(() => {\n    if (cursor.current) {\n      setCursor(cursor.current)\n    }\n  }, [cursor.current])\n\n  return (\n    <>\n      <div\n        id=\"xpra-desktop\"\n        className=\"absolute inset-0 z-30 overflow-hidden bg-gradient-to-br from-emerald-500 via-emerald-300 to-emerald-500\"\n        ref={root}\n        onMouseMove={onMouseMove}\n        onContextMenu={onContextMenu}\n        onMouseDown={onMouseDown}\n        onMouseUp={onMouseUp}\n      >\n        {state.connected &&\n          windows.map((w) => <AppWindow key={w.id} win={w} />)}\n\n        {children}\n      </div>\n      <div ref={cursor} className=\"xpra-cursor absolute z-50\" />\n      <style>{style}</style>\n    </>\n  )\n}\n","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React, { FC } from 'react'\n\nlet lastElementId = 1\n\nexport const AppSelect: FC<{\n  disabled?: boolean\n  label?: string\n  required?: boolean\n  value: string\n  options: Record<string, string>\n  onChange: (ev: React.ChangeEvent<HTMLSelectElement>) => void\n}> = ({ disabled, label, value, required, options, onChange }) => {\n  const htmlFor = `xpra_${++lastElementId}`\n  const inputClassNames =\n    'rounded bg-white border border-black-100 w-full p-1 px-2 disabled:opacity-40 disabled:cursor-not-allowed'\n\n  return (\n    <div>\n      {label && <label htmlFor={htmlFor}>{label}</label>}\n      <div>\n        <select\n          className={inputClassNames}\n          id={htmlFor}\n          required={required}\n          disabled={disabled}\n          defaultValue={value}\n          onChange={onChange}\n        >\n          {Object.entries(options).map(([k, v]) => (\n            <option key={k} value={k}>\n              {v}\n            </option>\n          ))}\n        </select>\n      </div>\n    </div>\n  )\n}\n\n/**\n * Button Component\n */\nexport const AppButton: FC<{\n  disabled?: boolean\n  label?: string\n  type?: 'button' | 'submit' | 'reset'\n  transparent?: boolean\n  onClick?: (ev: React.MouseEvent<HTMLButtonElement>) => void\n}> = ({ children, disabled, label, type, transparent, onClick }) => {\n  let inputClassNames =\n    'flex items-center justify-center relative rounded w-full p-1 px-2 disabled:opacity-40 disabled:cursor-not-allowed hover:outline hover:outline-1'\n\n  if (transparent) {\n    inputClassNames += ' border border border-transparent'\n  } else {\n    inputClassNames += ' bg-white border border-black-100'\n  }\n\n  return (\n    <button\n      className={inputClassNames}\n      disabled={disabled}\n      type={type || 'button'}\n      onClick={onClick}\n    >\n      {label || children}\n    </button>\n  )\n}\n\n/**\n * Text Input Component\n */\nexport const AppTextField: FC<{\n  type?: string\n  disabled?: boolean\n  label?: string\n  placeholder?: string\n  required?: boolean\n  value: string\n  onChange: (ev: React.ChangeEvent<HTMLInputElement>) => void\n}> = ({ disabled, label, value, type, placeholder, required, onChange }) => {\n  const htmlFor = `xpra_${++lastElementId}`\n  const inputClassNames =\n    'rounded bg-white border border-black-100 w-full p-1 px-2 disabled:opacity-40 disabled:cursor-not-allowed'\n\n  return (\n    <div>\n      {label && <label htmlFor={htmlFor}>{label}</label>}\n      <div>\n        <input\n          type={type || 'text'}\n          className={inputClassNames}\n          id={htmlFor}\n          placeholder={placeholder}\n          required={required}\n          disabled={disabled}\n          defaultValue={value}\n          onInput={onChange}\n        />\n      </div>\n    </div>\n  )\n}\n\n/**\n * Checkbox Input Component\n */\nexport const AppCheckbox: FC<{\n  label: string\n  value: boolean\n  onChange: (ev: React.ChangeEvent<HTMLInputElement>) => void\n}> = ({ label, value, onChange }) => {\n  return (\n    <div className=\"select-none\">\n      <label className=\"inline-flex items-center space-x-2 cursor-pointer\">\n        <input type=\"checkbox\" defaultChecked={value} onChange={onChange} />\n        <span>{label}</span>\n      </label>\n    </div>\n  )\n}\n","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React, { useContext, useState, useRef, useEffect, FC } from 'react'\nimport { ValueOf } from './types'\nimport { AppContext } from './context'\nimport { FadeInOutTransition } from './transitions'\nimport { ActionTypes, AppWindowState } from './store'\nimport { AppCheckbox, AppTextField, AppButton, AppSelect } from './inputs'\nimport { AppWindowCanvas, AppWindowIcon } from './desktop'\nimport {\n  XPRA_KEYBOARD_LAYOUTS,\n  XpraConnectionOptions,\n  browserLoadFile,\n} from 'xpra-html5-client'\n\ninterface AppMenuItem {\n  icon?: string\n  title: string\n  callback?: () => void\n  items?: AppMenuItem[]\n}\n\nconst panelClassNames = [\n  'shadow-lg',\n  'bg-emerald-100/50',\n  'opacity-90',\n  'rounded',\n]\n\nconst cs = (...args: string[]) => args.join(' ')\n\nexport const AppMenu: FC<{\n  items: AppMenuItem[]\n  root?: boolean\n  onCallback?: () => void\n}> = ({\n  items,\n  onCallback = () => {\n    /*noop */\n  },\n  root = true,\n}) => {\n  const ref = useRef<HTMLDivElement | null>(null)\n  const [hovering, setHovering] = useState(-1)\n\n  const classNames = ['max-h-96', 'max-w-xs']\n  if (root) {\n    classNames.push('top-full', 'left-0')\n  } else {\n    classNames.push('top-0', 'left-full', 'overflow-auto')\n  }\n\n  const onMouseOver = (i: number) => setHovering(i)\n  const onMouseLeave = () => setHovering(-1)\n  const onClose = (fn?: () => void) => {\n    if (fn) {\n      fn()\n    }\n    onCallback()\n  }\n\n  if (root) {\n    const checkOutsideClick = (ev: MouseEvent) => {\n      if (ref.current) {\n        const target = ev.target as HTMLElement\n        const hit =\n          target &&\n          (ref.current.contains(target) || target === ref.current.parentNode)\n\n        if (!hit) {\n          onClose()\n        }\n      }\n    }\n\n    useEffect(() => {\n      document.addEventListener('click', checkOutsideClick)\n\n      return () => {\n        document.removeEventListener('click', checkOutsideClick)\n      }\n    }, [ref])\n  }\n\n  return (\n    <div\n      ref={ref}\n      className={cs('absolute', 'shadow', 'bg-emerald-100/80', ...classNames)}\n      onMouseLeave={onMouseLeave}\n    >\n      {items.map(({ icon, title, items, callback }, i) => (\n        <div key={i} className=\"relative text-left\">\n          <div\n            className=\"p-2 hover:bg-white truncate flex space-x-2 items-center\"\n            onClick={() => onClose(callback)}\n            onMouseOver={() => onMouseOver(i)}\n          >\n            {icon && <img src={icon} className=\"w-4 h-4\" />}\n            <span>{title}</span>\n          </div>\n          {hovering === i && items && items.length > 0 && (\n            <AppMenu root={false} items={items} />\n          )}\n        </div>\n      ))}\n    </div>\n  )\n}\n\n/**\n * Panel Wrapper\n */\nexport const AppPanel: FC<{ classNames: string[] }> = ({\n  classNames,\n  children,\n}) => {\n  const className = cs('absolute', 'z-50', ...panelClassNames, ...classNames)\n\n  return <div className={className}>{children}</div>\n}\n\nexport const AppConnectionPanel: FC = () => {\n  const { xpra, state, dispatch } = useContext(AppContext)\n\n  const optionsLabel = state.showOptions ? 'Hide options' : 'Show options'\n\n  const updateOption = (\n    key: keyof XpraConnectionOptions,\n    value: ValueOf<XpraConnectionOptions>\n  ) =>\n    dispatch({\n      type: ActionTypes.SetOption,\n      payload: [key, value],\n    })\n\n  const enc = Object.fromEntries(\n    ['CBC', 'CFB', 'CTR'].map((k) => `AES-${k}`).map((k) => [k, k])\n  )\n\n  const inputs = [\n    {\n      key: 'reconnect',\n      label: 'Automatically reconnect',\n      component: AppCheckbox,\n    },\n    {\n      key: 'shareSession',\n      label: 'Share Session',\n      component: AppCheckbox,\n    },\n    {\n      key: 'stealSession',\n      label: 'Steal Session',\n      component: AppCheckbox,\n    },\n    {\n      key: 'clipboard',\n      label: 'Clipboard',\n      component: AppCheckbox,\n    },\n    {\n      key: 'clipboardImages',\n      label: 'Clipboard Images',\n      component: AppCheckbox,\n    },\n    {\n      key: 'fileTransfer',\n      label: 'File Transfer',\n      component: AppCheckbox,\n    },\n    {\n      key: 'printing',\n      label: 'Printing',\n      component: AppCheckbox,\n    },\n    {\n      key: 'bell',\n      label: 'Bell',\n      component: AppCheckbox,\n    },\n    {\n      key: 'notifications',\n      label: 'Notifications',\n      component: AppCheckbox,\n    },\n    {\n      key: 'openUrl',\n      label: 'Open URLs',\n      component: AppCheckbox,\n    },\n    {\n      key: 'audio',\n      label: 'Audio',\n      component: AppCheckbox,\n    },\n    {\n      key: 'showStartMenu',\n      label: 'XDG Menu',\n      component: AppCheckbox,\n    },\n    {\n      key: 'swapKeys',\n      label: 'Swap Ctrl and Cmd key',\n      component: AppCheckbox,\n    },\n    {\n      key: 'reverseScrollX',\n      label: 'Reverse X scroll',\n      component: AppCheckbox,\n    },\n    {\n      key: 'reverseScrollY',\n      label: 'Reverse Y scroll',\n      component: AppCheckbox,\n    },\n    {\n      key: 'keyboardLayout',\n      label: 'Keyboard Layout',\n      component: AppSelect,\n      options: XPRA_KEYBOARD_LAYOUTS,\n    },\n  ].map((input) => ({\n    ...input,\n    value: state.options[input.key as keyof XpraConnectionOptions],\n    onChange: (ev: React.ChangeEvent<HTMLInputElement>) =>\n      updateOption(input.key as keyof XpraConnectionOptions, ev.target.value),\n  }))\n\n  const onHostChange = (ev: React.ChangeEvent<HTMLInputElement>) =>\n    dispatch({\n      type: ActionTypes.SetHost,\n      payload: ev.target.value,\n    })\n\n  const onUsernameChange = (ev: React.ChangeEvent<HTMLInputElement>) =>\n    updateOption('username', ev.target.value)\n\n  const onPasswordChange = (ev: React.ChangeEvent<HTMLInputElement>) =>\n    updateOption('password', ev.target.value)\n\n  const onEncChange = (ev: React.ChangeEvent<HTMLSelectElement>) =>\n    updateOption('encryption', ev.target.value || null)\n\n  const onKeyChange = (ev: React.ChangeEvent<HTMLInputElement>) =>\n    updateOption('encryptionKey', ev.target.value)\n\n  const onConnect = (ev: React.FormEvent<HTMLFormElement>) => {\n    ev.preventDefault()\n\n    dispatch({\n      type: ActionTypes.SetError,\n      payload: '',\n    })\n\n    xpra.connect(state.host, state.options)\n  }\n\n  const onOptionsClick = () =>\n    dispatch({\n      type: ActionTypes.SetShowOptions,\n      payload: !state.showOptions,\n    })\n\n  return (\n    <AppPanel\n      classNames={[\n        'p-8',\n        'top-1/2',\n        'left-1/2 transform',\n        '-translate-x-1/2',\n        '-translate-y-1/2',\n        'w-11/12',\n        'max-w-xl',\n        'max-h-full',\n        'overflow-auto',\n      ]}\n    >\n      <form className=\"space-y-4\" onSubmit={onConnect}>\n        <div className=\"space-y-2\">\n          <AppTextField\n            required\n            placeholder=\"Host\"\n            value={state.host}\n            onChange={onHostChange}\n          />\n\n          <div className=\"grid gap-2 grid-cols-2\">\n            <AppTextField\n              placeholder=\"Username\"\n              value={state.options.username}\n              onChange={onUsernameChange}\n            />\n\n            <AppTextField\n              type=\"password\"\n              placeholder=\"Password\"\n              value={state.options.password}\n              onChange={onPasswordChange}\n            />\n\n            <AppSelect\n              disabled\n              value={state.options.encryption || ''}\n              options={{ '': 'No encryption', ...enc }}\n              onChange={onEncChange}\n            />\n\n            <AppTextField\n              disabled\n              type=\"password\"\n              placeholder=\"Encryption key\"\n              value={state.options.encryptionKey}\n              onChange={onKeyChange}\n            />\n          </div>\n        </div>\n\n        {state.error && (\n          <div className=\"bg-red-300 border border-red-500 text-red-500 p-2 rounded\">\n            {state.error}\n          </div>\n        )}\n\n        <div className=\"flex space-x-2\">\n          <AppButton label=\"Connect\" type=\"submit\" />\n          <AppButton label={optionsLabel} onClick={onOptionsClick} />\n        </div>\n\n        <FadeInOutTransition toggled={state.showOptions}>\n          <div className=\"px-2 text-sm\">\n            {inputs.map(({ component, key, ...input }) => {\n              const Component = component as FC\n              return <Component key={key} {...input} />\n            })}\n          </div>\n        </FadeInOutTransition>\n      </form>\n    </AppPanel>\n  )\n}\n\n/**\n * Connection panel\n */\nexport const AppDebugPanel: FC = () => {\n  const { state } = useContext(AppContext)\n\n  const rows = [\n    ['Last server ping', state.stats.lastServerPing],\n    ['Last client echo', state.stats.lastClientEcho],\n    ['Client ping latency', state.stats.clientPingLatency],\n    ['Server ping latency', state.stats.serverPingLatency],\n    ['Server load', state.stats.serverLoad.join(' / ')],\n    ['Window count', state.windows.length],\n  ]\n\n  return (\n    <div className=\"absolute bottom-1 left-1 p-1 z-0 opacity-50 bg-emerald-100 rounded\">\n      <table className=\"text-xs\">\n        <tbody>\n          {rows.map(([label, value]) => (\n            <tr key={label}>\n              <td className=\"p-1\">{label}</td>\n              <td className=\"p-1 text-right text-gray-500\">{value}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  )\n}\n\n/**\n * Minimized window tray\n */\nexport const AppTrayPanel: FC = () => {\n  const { wm, state, dispatch, xpra } = useContext(AppContext)\n\n  const [menuVisible, setMenuVisible] = useState(false)\n  const minimized = state.windows.filter((w) => w.minimized)\n  const trays = state.windows.filter((w) => w.tray)\n\n  const menu = [\n    ...state.menu.map((sub) => ({\n      title: sub.name,\n      icon: sub.icon,\n      items: sub.entries.map((entry) => ({\n        title: entry.name,\n        icon: entry.icon,\n        callback: () => {\n          xpra.sendStartCommand(entry.name, entry.exec, false)\n        },\n      })),\n    })),\n    {\n      title: 'Server',\n      items: [\n        {\n          title: 'Shutdown server',\n          callback: () => {\n            if (confirm('Are you sure you want to shut down the server ?')) {\n              xpra.sendShutdown()\n            }\n          },\n        },\n      ],\n    },\n  ]\n\n  const onDisconnect = () => xpra.disconnect()\n\n  const onClick =\n    (w: AppWindowState) => (ev: React.MouseEvent<HTMLButtonElement>) => {\n      ev.stopPropagation()\n      ev.preventDefault()\n\n      const win = wm.getWindow(w.id)\n      if (win) {\n        wm.restore(win)\n        wm.raise(win)\n\n        dispatch({\n          type: ActionTypes.RaiseWindow,\n          payload: win.attributes,\n        })\n      }\n    }\n\n  const onMenuToggle = () => setMenuVisible(!menuVisible)\n\n  const onMenuCallback = () => {\n    setMenuVisible(false)\n  }\n\n  const onPollClipboard = () => xpra.clipboard.poll()\n\n  const onFileUpload = async () => {\n    const files = await browserLoadFile()\n    files.forEach(({ buffer, name, size, type }) =>\n      xpra.sendFile(name, type, size, buffer)\n    )\n  }\n\n  return (\n    <AppPanel\n      classNames={[\n        'top-1',\n        'left-1/2',\n        '-translate-x-1/2',\n        'p-1',\n        'select-none',\n      ]}\n    >\n      <div className=\"flex space-x-4 px-2\">\n        <div className=\"flex space-x-1\">\n          {state.menu.length > 0 && (\n            <AppButton transparent={true} onClick={onMenuToggle}>\n              <i className=\"fa fa-bars pointer-events-none\" />\n              <FadeInOutTransition toggled={menuVisible}>\n                <AppMenu items={menu} onCallback={onMenuCallback} />\n              </FadeInOutTransition>\n            </AppButton>\n          )}\n\n          <AppButton transparent={true} onClick={onDisconnect}>\n            <i className=\"fa fa-unlink\" />\n          </AppButton>\n\n          {state.options.clipboard && (\n            <AppButton transparent={true} onClick={onPollClipboard}>\n              <i className=\"fa fa-clipboard\" />\n            </AppButton>\n          )}\n          {state.options.fileTransfer && (\n            <AppButton transparent={true} onClick={onFileUpload}>\n              <i className=\"fa fa-upload\" />\n            </AppButton>\n          )}\n        </div>\n\n        {minimized.length > 0 && (\n          <div className=\"flex space-x-1\">\n            {minimized.map((win) => (\n              <AppButton key={win.id} transparent={true} onClick={onClick(win)}>\n                <div\n                  className=\"flex space-x-1 items-center\"\n                  style={{ maxWidth: '128px' }}\n                >\n                  <div className=\"w-4 h-4\">\n                    <AppWindowIcon win={win} />\n                  </div>\n                  <div className=\"truncate text-center text-sm\">\n                    {win.title}\n                  </div>\n                </div>\n              </AppButton>\n            ))}\n          </div>\n        )}\n\n        {trays.length > 0 && (\n          <div className=\"flex space-x-1\">\n            {trays.map((win) => (\n              <div key={win.id} className=\"flex space-x-1 items-center\">\n                <div\n                  className=\"flex items-center justify-center w-4 h-4 overflow-hidden\"\n                  title={win.title}\n                >\n                  <AppWindowCanvas id={win.id} />\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </AppPanel>\n  )\n}\n\nexport const AppConnectingPanel: FC = () => {\n  const { state, xpra } = useContext(AppContext)\n\n  const onDisconnect = () => xpra.disconnect()\n  return (\n    <AppPanel\n      classNames={[\n        'p-8',\n        'top-1/2',\n        'left-1/2 transform',\n        '-translate-x-1/2',\n        '-translate-y-1/2',\n        'w-96',\n      ]}\n    >\n      <div className=\"space-y-4\">\n        <div className=\"text-center\">Connecting to {state.host}</div>\n        <div>\n          <AppButton onClick={onDisconnect}>Cancel</AppButton>\n        </div>\n      </div>\n    </AppPanel>\n  )\n}\n","/**\n * Xpra Typescript Client React UI\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport React, { useContext } from 'react'\nimport { AppContext, AppContextProvider } from './context'\nimport { AppDesktop } from './desktop'\nimport {\n  AppConnectionPanel,\n  AppDebugPanel,\n  AppTrayPanel,\n  AppConnectingPanel,\n} from './panels'\nimport { FadeInOutTransition } from './transitions'\nimport { XpraClient, XpraWindowManager } from 'xpra-html5-client'\n\nexport function AppInner() {\n  const { state } = useContext(AppContext)\n  return (\n    <>\n      <FadeInOutTransition toggled={!state.connected}>\n        <AppConnectionPanel />\n      </FadeInOutTransition>\n\n      <FadeInOutTransition toggled={!state.started && state.connected}>\n        <AppConnectingPanel />\n      </FadeInOutTransition>\n\n      <AppDesktop>{state.connected && <AppDebugPanel />}</AppDesktop>\n\n      <FadeInOutTransition toggled={state.started}>\n        <AppTrayPanel />\n      </FadeInOutTransition>\n    </>\n  )\n}\n\nexport function App({ xpra, wm }: { xpra: XpraClient; wm: XpraWindowManager }) {\n  return (\n    <AppContextProvider wm={wm} xpra={xpra}>\n      <AppInner />\n    </AppContextProvider>\n  )\n}\n","/**\n * Xpra Typescript Client Example\n * @link https://github.com/andersevenrud/xpra-html5-client\n * @author Anders Evenrud <andersevenrud@gmail.com>\n * @license Mozilla Public License Version 2.0\n */\n\nimport './style.css'\nimport ReactDOM from 'react-dom'\nimport { createElement } from 'react'\nimport { XpraClient, XpraWindowManager } from 'xpra-html5-client'\nimport { App } from './app/App'\nimport XpraWorker from './worker?worker'\n\nasync function main() {\n  const app = document.querySelector<HTMLDivElement>('#app')\n  const worker = new XpraWorker()\n  const xpra = new XpraClient({ worker })\n  const wm = new XpraWindowManager(xpra)\n\n  await xpra.init()\n  wm.init()\n\n  if (app) {\n    ReactDOM.render(createElement(App, { xpra, wm }), app)\n  }\n}\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  main()\n})\n"],"names":["createContext","useReducer","useState","useEffect","useContext","useRef","useCallback","createRef","XpraWorker","createElement"],"mappings":"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"}